# 트랜잭션과 락에 대한 이해
트랜잭션은 데이터베이스에서의 작업의 완전성을 보장하며, 데이터의 정합성을 유지하는 핵심 기능입니다. 여러 논리 작업을 그룹화하여 모두 함께 성공하거나 실패하도록 보장합니다. 하지만 모든 작업에 트랜잭션을 적용하는 것이 반드시 좋은 것만은 아닙니다. 예를 들어, 유저가 글을 쓰는 과정에서 필요한 트랜잭션을 적절히 구성하는 것이 중요합니다:

```
유저 정보 가져오기
글쓰기 오류 판별
업로드 파일 확인 및 저장
사용자 입력 정보를 DBMS에 저장
저장 내용을 DBMS에서 조회
게시물 등록 알림을 메일로 전송
알림 메일 발송 이력을 DBMS에 저장
```
이 중 3번에서 4번 사이와 7번에서 실제로 DB에 저장하는 로직이 트랜잭션으로 관리될 필요가 있습니다. 특히 네트워크를 사용하는 작업(예: 이메일 전송)은 트랜잭션 외부에서 처리해야 합니다.

## 잠금 메커니즘
MySQL에서는 다양한 레벨의 잠금(락)을 제공하여 데이터베이스의 동시성과 일관성을 관리합니다.

### 글로벌 락
MySQL 서버 전체에 영향을 주는 매우 큰 범위의 락입니다. 예를 들어 백업 중 서버의 모든 변경 작업을 일시 중지할 때 사용됩니다.

### 백업 락
InnoDB 스토리지 엔진은 트랜잭션을 지원하여 데이터의 일관성을 유지하면서도 백업 도중 일부 작업을 계속 허용할 수 있습니다. 예를 들어, 특정 세션에서 백업 락을 획득하면 테이블 구조나 사용자 인증 정보 변경은 제한되지만, 일반적인 데이터 변경은 가능합니다.

### 테이블 락
테이블 단위로 잠금을 설정하여 해당 테이블의 데이터 변경을 관리합니다. InnoDB에서는 테이블 락 대신 더 세분화된 레코드 기반의 잠금을 주로 사용합니다.

### 네임드 락
사용자가 정의한 임의의 문자열에 대한 잠금을 설정할 수 있는 기능으로, 동기화 필요성이 높은 작업에서 유용합니다.

### 메타데이터 락
테이블이나 뷰 같은 데이터베이스 객체의 구조 변경 시 자동으로 획득되는 잠금입니다.

### InnoDB 스토리지 엔진 잠금
InnoDB는 레코드 기반의 잠금을 제공하여 높은 수준의 동시성을 지원합니다. 레코드 잠금, 갭 락, 넥스트 키 락 등이 있으며, 이들은 InnoDB의 데이터 일관성과 무결성을 보장하는 데 중요한 역할을 합니다.

## MySQL의 격리 수준
MySQL은 다양한 격리 수준을 제공하여 트랜잭션 중 다른 트랜잭션의 영향을 받지 않도록 합니다
```
Read Uncommitted: 다른 트랜잭션의 변경 내용이 커밋되지 않은 상태에서도 보이는 격리 수준입니다. 데이터의 "Dirty Read"가 발생할 수 있습니다.
Read Committed: 커밋된 데이터만 조회할 수 있으며, "Non-Repeatable Read" 현상이 발생할 수 있습니다.
Repeatable Read: MySQL의 기본 격리 수준으로, 한 트랜잭션 내에서 일관된 조회를 보장합니다. InnoDB에서는 "Phantom Read"도 방지합니다.
Serializable: 가장 엄격한 격리 수준으로, 모든 읽기 작업에 잠금을 사용하여 동시성을 제한합니다.
```
각 격리 수준은 특정 애플리케이션의 요구 사항에 따라 선택되어야 하며, 올바른 잠금 전략과 함께 사용되어야 합니다. 이러한 메커니즘을 통해 MySQL은 다양한 환경에서 데이터의 일관성과 성능을 보장할 수 있습니다.
